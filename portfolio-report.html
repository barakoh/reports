<!DOCTYPE html>
<html dir="rtl" lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>דוח ניהול עושר | לקוח לדוגמה</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700&display=swap');

        :root {
            --bg-body: #f4f5f7;
            --bg-card: #ffffff;
            --bg-subtle: #f8fafc;
            --text-main: #1e293b;
            --text-secondary: #64748b;
            --text-light: #94a3b8;
            --brand-primary: #0f172a;
            --brand-accent: #c29d59;
            --positive: #059669;
            --positive-bg: #ecfdf5;
            --negative: #dc2626;
            --warning: #d97706;
            --color-pension: #1e3a8a;
            --color-gemel: #3b82f6;
            --color-hish: #94a3b8;
            --border-light: #e2e8f0;
            --border-medium: #cbd5e1;
            --radius: 8px;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { font-family: 'Assistant', sans-serif; background: var(--bg-body); color: var(--text-main); line-height: 1.6; padding-bottom: 80px; }
        .container { margin: 0 auto; padding: 0 20px; }
        .container-narrow { max-width: 900px; }
        .container-wide { max-width: 1000px; }

        /* Cover Page */
        .cover-section { padding: 60px 0; min-height: 100vh; display: flex; flex-direction: column; justify-content: center; }
        .cover-header { text-align: center; margin-bottom: 60px; border-bottom: 2px solid var(--brand-accent); padding-bottom: 40px; }
        .logo-icon { font-size: 32px; color: var(--brand-primary); margin-bottom: 16px; }
        .cover-title { font-family: inherit; font-size: 42px; font-weight: 700; color: var(--brand-primary); margin-bottom: 8px; }
        .cover-subtitle { font-size: 18px; color: var(--text-secondary); font-weight: 500; }
        .date-badge { display: inline-block; background: var(--brand-primary); color: #fff; padding: 4px 12px; border-radius: 4px; font-size: 12px; font-weight: 600; margin-bottom: 20px; }

        .content-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin-bottom: 60px; }
        .text-section h2 { font-size: 18px; color: var(--brand-primary); margin-bottom: 16px; padding-bottom: 8px; border-bottom: 1px solid var(--brand-accent); }
        .text-section p { font-size: 15px; color: var(--text-secondary); margin-bottom: 16px; }
        .highlight-box { background: var(--positive-bg); border-right: 3px solid var(--positive); padding: 16px; border-radius: var(--radius); font-size: 14px; color: var(--text-main); }
        .text-green { color: var(--positive); }

        .chart-section { background: var(--bg-card); padding: 40px; border-radius: var(--radius); box-shadow: 0 4px 20px rgba(0,0,0,0.05); }
        .chart-header { text-align: center; margin-bottom: 30px; }
        .chart-title { font-size: 18px; font-weight: 700; color: var(--brand-primary); }
        .line-chart-container { padding: 0 10px; }
        .line-chart { width: 100%; height: 220px; }
        .chart-legend { display: flex; justify-content: center; gap: 24px; margin-top: 20px; flex-wrap: wrap; }
        .chart-legend .legend-item { display: flex; align-items: center; gap: 8px; font-size: 13px; color: var(--text-secondary); }
        .chart-legend .legend-dot { width: 10px; height: 10px; border-radius: 50%; }
        .chart-legend strong { color: var(--text-main); margin-right: 4px; }

        .nav-boxes { display: flex; gap: 24px; justify-content: center; margin-top: 60px; }
        .nav-box {
            background: var(--bg-card);
            border: 2px solid var(--border-light);
            border-radius: var(--radius);
            padding: 32px 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 220px;
        }
        .nav-box:hover { border-color: var(--brand-primary); transform: translateY(-4px); box-shadow: var(--shadow-md); }
        .nav-box-icon { font-size: 32px; color: var(--brand-primary); margin-bottom: 16px; }
        .nav-box-title { font-size: 18px; font-weight: 700; color: var(--brand-primary); margin-bottom: 8px; }
        .nav-box-desc { font-size: 13px; color: var(--text-secondary); }

        /* Report Page */
        .header-card { background: var(--brand-primary); padding: 24px 0; margin-bottom: 32px; border-radius: var(--radius); }
        .header-content { display: flex; justify-content: space-between; align-items: center; }
        .brand { display: flex; align-items: center; gap: 12px; }
        .brand-icon-box { width: 48px; height: 48px; border-radius: 12px; background: rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center; color: #fff; font-size: 20px; }
        .brand-text h1 { color: #fff; font-size: 22px; font-weight: 700; }
        .brand-text p { color: rgba(255,255,255,0.7); font-size: 13px; }
        .client-info-box { text-align: left; }
        .client-name-lg { color: #fff; font-size: 18px; font-weight: 700; }
        .report-date-sm { color: rgba(255,255,255,0.7); font-size: 12px; }

        /* Dashboard Summary */
        .dashboard-summary { background: var(--bg-card); border-radius: var(--radius); box-shadow: var(--shadow-sm); margin-bottom: 32px; overflow: hidden; }
        .summary-header { background: linear-gradient(135deg, var(--brand-primary) 0%, #1e40af 100%); padding: 28px 32px; text-align: center; }
        .total-label { font-size: 12px; color: rgba(255,255,255,0.7); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; }
        .total-amount { font-size: 36px; font-weight: 700; color: #fff; letter-spacing: -1px; }
        .total-sub { font-size: 14px; color: rgba(255,255,255,0.8); margin-top: 8px; }
        .total-sub .text-green { color: #4ade80; font-weight: 600; }
        .gauges-row { display: flex; justify-content: space-around; padding: 28px 20px; background: var(--bg-card); }
        .gauge-item { display: flex; flex-direction: column; align-items: center; text-align: center; flex: 1; }
        .gauge-item .gauge-wrapper { position: relative; width: 100px; height: 100px; margin-bottom: 12px; }
        .gauge-item .gauge-svg { width: 100%; height: 100%; transform: rotate(-90deg); }
        .gauge-item .gauge-value { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 22px; font-weight: 700; color: var(--brand-primary); }
        .gauge-item .gauge-label { font-size: 13px; font-weight: 600; color: var(--text-main); margin-bottom: 4px; }
        .gauge-item .gauge-sub { font-size: 12px; color: var(--text-secondary); }
        .gauge-bg { fill: none; stroke: var(--bg-subtle); stroke-width: 8; }
        .gauge-fill { fill: none; stroke-width: 8; stroke-linecap: round; stroke-dasharray: 264; transition: stroke-dashoffset 1s ease-out; }

        .holdings-container { display: flex; flex-direction: column; gap: 16px; }
        .category-card { background: var(--bg-card); border-radius: var(--radius); box-shadow: var(--shadow-sm); overflow: hidden; border: 1px solid var(--border-light); }
        .category-header { padding: 20px 24px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; background: linear-gradient(to left, #fff, #f8fafc); transition: background 0.2s; }
        .category-header:hover { background: #f1f5f9; }
        .cat-main { display: flex; align-items: center; gap: 16px; }
        .cat-icon { width: 44px; height: 44px; border-radius: 12px; display: flex; align-items: center; justify-content: center; color: #fff; font-size: 18px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15); }
        .cat-title h3 { font-size: 16px; font-weight: 700; color: var(--brand-primary); }
        .cat-meta { font-size: 13px; color: var(--text-secondary); }
        .cat-stats { text-align: left; display: flex; flex-direction: column; align-items: flex-end; }
        .amount { font-weight: 700; color: var(--brand-primary); font-size: 16px; }
        .yield { font-size: 13px; font-weight: 600; background: var(--positive-bg); color: var(--positive); padding: 2px 8px; border-radius: 12px; margin-top: 4px; }

        .accordion-body { max-height: 0; overflow: hidden; transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1); background: var(--bg-subtle); }
        .accordion-body.open { max-height: 3000px; }
        .chevron { color: var(--text-light); transition: transform 0.3s; font-size: 10px; margin-right: 12px; display: inline-block; width: 0; height: 0; border-left: 6px solid transparent; border-right: 6px solid transparent; border-top: 8px solid var(--text-secondary); }
        .chevron::before { content: none !important; }
        .chevron.open { transform: rotate(180deg); }

        .product-row { padding: 16px 24px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid var(--border-light); background: var(--bg-card); cursor: pointer; }
        .product-row:hover { background: var(--bg-subtle); }
        .product-info { display: flex; align-items: center; gap: 12px; }
        .company-logo { width: 36px; height: 36px; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #fff; font-size: 12px; font-weight: 700; }
        .product-name { font-weight: 600; color: var(--text-main); }
        .product-meta { font-size: 12px; color: var(--text-light); margin-top: 2px; }
        .product-stats { display: flex; flex-direction: column; align-items: flex-end; margin-left: auto; margin-right: 16px; }
        .product-amount { font-weight: 700; color: var(--brand-primary); font-size: 15px; }
        .product-yield { font-size: 13px; font-weight: 600; margin-top: 2px; }
        .product-id { font-size: 12px; color: var(--text-light); }

        .track-container { padding: 16px 24px; }
        .track-row { display: flex; align-items: center; padding: 12px 16px; background: #fff; border: 1px solid var(--border-light); border-radius: var(--radius); margin-bottom: 8px; cursor: pointer; }
        .track-title { flex: 1; }
        .track-row:hover { border-color: var(--brand-primary); }
        .track-row.has-alert { border-right: 3px solid var(--warning); }
        .alert-icon { color: var(--warning); margin-left: 8px; font-size: 14px; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .track-title h5 { font-size: 14px; font-weight: 600; color: var(--text-main); }
        .track-sub { font-size: 12px; color: var(--text-secondary); }
        .mini-stat { text-align: center; padding: 0 16px; min-width: 80px; }
        .mini-val { font-weight: 700; font-size: 14px; }
        .mini-label { font-size: 10px; color: var(--text-light); text-transform: uppercase; }

        .track-details { padding: 16px; background: #f8fafc; border-radius: var(--radius); margin-top: 8px; }
        .metrics-strip { display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 16px; }
        .metric-box { background: #fff; padding: 12px 16px; border-radius: 6px; border: 1px solid var(--border-light); flex: 1; min-width: 120px; }
        .metric-box .label { font-size: 10px; color: var(--text-light); text-transform: uppercase; margin-bottom: 4px; }
        .metric-box .val { font-size: 16px; font-weight: 700; color: var(--brand-primary); }

        .efficiency-dots { display: flex; gap: 3px; }
        .efficiency-dots span { font-size: 12px; color: var(--border-light); }
        .efficiency-dots span::before { content: '★'; }
        .efficiency-dots span.fill { color: var(--brand-accent); }

        .alt-table-wrapper { background: #fff; border: 1px solid var(--border-light); border-radius: var(--radius); overflow: hidden; }
        .alt-table-header { background: var(--bg-subtle); padding: 10px 16px; font-size: 12px; font-weight: 700; color: var(--brand-primary); border-bottom: 1px solid var(--border-light); }
        .alt-table { width: 100%; border-collapse: collapse; font-size: 13px; }
        .alt-table th { background: var(--bg-subtle); padding: 10px 12px; text-align: right; font-weight: 600; color: var(--text-secondary); font-size: 11px; text-transform: uppercase; }
        .alt-table td { padding: 12px; border-bottom: 1px solid var(--border-light); }
        .alt-table tr:last-child td { border-bottom: none; }
        .badge-rec { display: inline-block; background: var(--positive-bg); color: var(--positive); font-size: 10px; font-weight: 700; padding: 2px 6px; border-radius: 4px; margin-right: 6px; }

        .floating-footer { position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%); background: #fff; padding: 10px 10px; border-radius: 50px; box-shadow: 0 10px 25px -5px rgba(0,0,0,0.1); display: flex; gap: 8px; z-index: 100; border: 1px solid var(--border-light); }
        .btn { border: none; padding: 10px 24px; border-radius: 24px; font-family: inherit; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; gap: 8px; }
        .btn-ghost { background: transparent; color: var(--text-secondary); }
        .btn-ghost:hover { background: var(--bg-subtle); color: var(--text-main); }
        .btn-primary { background: var(--brand-primary); color: #fff; }
        .btn-primary:hover { background: #020617; transform: translateY(-1px); }

        @media (max-width: 768px) {
            .content-grid { grid-template-columns: 1fr; }
            .gauges-row { flex-direction: column; gap: 24px; }
            .total-amount { font-size: 28px; }
            .header-content { flex-direction: column; gap: 16px; text-align: center; }
            .client-info-box { text-align: center; }
        }

        @media print {
            body { background: #fff; padding: 0; }
            .floating-footer { display: none; }
            .no-print { display: none; }
            .cover-section { min-height: auto; padding: 40px 0; }
            .accordion-body { max-height: none !important; }
            .page-break { page-break-before: always; }
        }
    </style>
</head>
<body>

    <!-- COVER PAGE -->
    <div class="cover-section">
        <div class="container container-narrow">
            <header class="cover-header">
                <div class="logo-icon"><i class="fas fa-chart-pie"></i></div>
                <div class="date-badge">ינואר 2026</div>
                <h1 class="cover-title">סקירה חודשית וניתוח תיק</h1>
                <div class="cover-subtitle">ישראל ישראלי, ת.ז 123456789</div>
            </header>

            <div class="content-grid">
                <div class="text-section">
                    <h2>מגמות בשוק ההון</h2>
                    <p>שוק ההון הישראלי המשיך להציב מגמה חיובית בחודש האחרון, עם עליות ברוב המדדים המובילים. מדד ת"א 125 רשם עלייה של כ-3.2%, בעוד מדד S&P 500 האמריקאי הוסיף כ-2.8%.</p>
                    <div class="highlight-box">
                        <i class="fas fa-lightbulb"></i> <strong>השורה התחתונה:</strong> הסביבה הכלכלית תומכת בהמשך אחזקה במניות, אך מומלץ לשמור על רכיב מזומן נזיל לניצול הזדמנויות.
                    </div>
                </div>

                <div class="text-section">
                    <h2>ניתוח מבנה התיק האישי</h2>
                    <p>ישראל, בהתאם למדיניות ההשקעה שקבענו, התיק שלך שומר על חשיפה מנייתית של כ-<strong>65%</strong>.</p>
                    <p>שווי תיק נכסים כולל עומד על <strong>₪1,250,000</strong> עם תשואה של <strong class="text-green">+8.5%</strong> מתחילת השנה.</p>
                    <p>הנכסים שלך מפוזרים ב-4 קטגוריות: פנסיה, גמל, השתלמות והשקעות אחרות.</p>
                </div>
            </div>

            <div class="chart-section">
                <div class="chart-header">
                    <div class="chart-title">ביצועי המוצרים מתחילת השנה (YTD)</div>
                </div>
                <div class="line-chart-container">
                    <svg class="line-chart" viewBox="0 0 500 200" preserveAspectRatio="xMidYMid meet">
                        <line x1="50" y1="20" x2="480" y2="20" stroke="#e2e8f0" stroke-dasharray="4"/>
                        <line x1="50" y1="60" x2="480" y2="60" stroke="#e2e8f0" stroke-dasharray="4"/>
                        <line x1="50" y1="100" x2="480" y2="100" stroke="#e2e8f0" stroke-dasharray="4"/>
                        <line x1="50" y1="140" x2="480" y2="140" stroke="#e2e8f0" stroke-dasharray="4"/>
                        <line x1="50" y1="180" x2="480" y2="180" stroke="#e2e8f0"/>

                        <text x="40" y="25" fill="#94a3b8" font-size="10" text-anchor="end">15%</text>
                        <text x="40" y="65" fill="#94a3b8" font-size="10" text-anchor="end">10%</text>
                        <text x="40" y="105" fill="#94a3b8" font-size="10" text-anchor="end">5%</text>
                        <text x="40" y="145" fill="#94a3b8" font-size="10" text-anchor="end">0%</text>

                        <text x="70" y="195" fill="#94a3b8" font-size="10" text-anchor="middle">ינו׳</text>
                        <text x="140" y="195" fill="#94a3b8" font-size="10" text-anchor="middle">מרץ</text>
                        <text x="210" y="195" fill="#94a3b8" font-size="10" text-anchor="middle">מאי</text>
                        <text x="280" y="195" fill="#94a3b8" font-size="10" text-anchor="middle">יולי</text>
                        <text x="350" y="195" fill="#94a3b8" font-size="10" text-anchor="middle">ספט׳</text>
                        <text x="420" y="195" fill="#94a3b8" font-size="10" text-anchor="middle">נוב׳</text>
                        <text x="470" y="195" fill="#94a3b8" font-size="10" text-anchor="middle">היום</text>

                        <defs>
                            <linearGradient id="gradPension" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" stop-color="#1e3a8a"/><stop offset="100%" stop-color="#1e3a8a" stop-opacity="0"/>
                            </linearGradient>
                            <linearGradient id="gradGemel" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" stop-color="#dc2626"/><stop offset="100%" stop-color="#dc2626" stop-opacity="0"/>
                            </linearGradient>
                            <linearGradient id="gradHish" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" stop-color="#7c3aed"/><stop offset="100%" stop-color="#7c3aed" stop-opacity="0"/>
                            </linearGradient>
                            <linearGradient id="gradInvest" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" stop-color="#059669"/><stop offset="100%" stop-color="#059669" stop-opacity="0"/>
                            </linearGradient>
                        </defs>

                        <path d="M70,140 L140,125 L210,115 L280,95 L350,80 L420,65 L470,52 L470,180 L70,180 Z" fill="url(#gradPension)" opacity="0.3"/>
                        <path d="M70,140 L140,130 L210,120 L280,100 L350,85 L420,70 L470,58 L470,180 L70,180 Z" fill="url(#gradGemel)" opacity="0.3"/>
                        <path d="M70,140 L140,128 L210,118 L280,98 L350,82 L420,68 L470,55 L470,180 L70,180 Z" fill="url(#gradHish)" opacity="0.3"/>
                        <path d="M70,140 L140,122 L210,110 L280,88 L350,72 L420,58 L470,45 L470,180 L70,180 Z" fill="url(#gradInvest)" opacity="0.3"/>

                        <polyline points="70,140 140,125 210,115 280,95 350,80 420,65 470,52" fill="none" stroke="#1e3a8a" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                        <polyline points="70,140 140,130 210,120 280,100 350,85 420,70 470,58" fill="none" stroke="#dc2626" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                        <polyline points="70,140 140,128 210,118 280,98 350,82 420,68 470,55" fill="none" stroke="#7c3aed" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                        <polyline points="70,140 140,122 210,110 280,88 350,72 420,58 470,45" fill="none" stroke="#059669" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>

                        <circle cx="470" cy="52" r="5" fill="#1e3a8a"/>
                        <circle cx="470" cy="58" r="5" fill="#dc2626"/>
                        <circle cx="470" cy="55" r="5" fill="#7c3aed"/>
                        <circle cx="470" cy="45" r="5" fill="#059669"/>
                    </svg>

                    <div class="chart-legend">
                        <div class="legend-item"><span class="legend-dot" style="background: #1e3a8a;"></span>פנסיה <strong>+9.2%</strong></div>
                        <div class="legend-item"><span class="legend-dot" style="background: #dc2626;"></span>גמל <strong>+8.1%</strong></div>
                        <div class="legend-item"><span class="legend-dot" style="background: #7c3aed;"></span>השתלמות <strong>+8.8%</strong></div>
                        <div class="legend-item"><span class="legend-dot" style="background: #059669;"></span>השקעות אחרות <strong>+11.5%</strong></div>
                    </div>
                </div>
            </div>

            <div class="nav-boxes">
                <div class="nav-box" onclick="scrollToReport()">
                    <div class="nav-box-icon"><i class="fas fa-chart-pie"></i></div>
                    <div class="nav-box-title">דוח פנסיוני</div>
                    <div class="nav-box-desc">פנסיה, גמל, השתלמות והשקעות</div>
                </div>
                <div class="nav-box" onclick="scrollToInsurance()">
                    <div class="nav-box-icon"><i class="fas fa-shield-alt"></i></div>
                    <div class="nav-box-title">דוח ביטוחי</div>
                    <div class="nav-box-desc">בריאות, סיעוד וביטוחי חיים</div>
                </div>
            </div>
        </div>
    </div>

    <div class="page-break"></div>

    <!-- DETAILED REPORT -->
    <div id="detailed-report" class="report-section">
        <div class="container container-wide">

            <header class="header-card">
                <div class="container header-content">
                    <div class="brand">
                        <div class="brand-icon-box"><i class="fas fa-chart-pie"></i></div>
                        <div class="brand-text">
                            <h1>Portfolio Expert</h1>
                            <p>ניהול עושר פיננסי</p>
                        </div>
                    </div>
                    <div class="client-info-box">
                        <div class="client-name-lg">ישראל ישראלי</div>
                        <div class="report-date-sm">דוח מצב נכון ל-19/01/2026</div>
                    </div>
                </div>
            </header>

            <section class="dashboard-summary">
                <div class="summary-header">
                    <div class="total-value">
                        <div class="total-label">שווי תיק נוכחי</div>
                        <div class="total-amount">₪1,250,000</div>
                        <div class="total-sub"><span class="text-green"><i class="fas fa-arrow-up"></i> +8.5%</span> מתחילת השנה</div>
                    </div>
                </div>
                <div class="gauges-row">
                    <div class="gauge-item">
                        <div class="gauge-wrapper">
                            <svg class="gauge-svg" viewBox="0 0 100 100">
                                <circle class="gauge-bg" cx="50" cy="50" r="42"></circle>
                                <circle class="gauge-fill" cx="50" cy="50" r="42" style="stroke-dashoffset: 92; stroke: var(--brand-primary);"></circle>
                            </svg>
                            <div class="gauge-value">65%</div>
                        </div>
                        <div class="gauge-label">חשיפה למניות</div>
                        <div class="gauge-sub">יעד מודל: 70%</div>
                    </div>
                    <div class="gauge-item">
                        <div class="gauge-wrapper">
                            <svg class="gauge-svg" viewBox="0 0 100 100">
                                <circle class="gauge-bg" cx="50" cy="50" r="42"></circle>
                                <circle class="gauge-fill" cx="50" cy="50" r="42" style="stroke-dashoffset: 106; stroke: var(--color-gemel);"></circle>
                            </svg>
                            <div class="gauge-value">60%</div>
                        </div>
                        <div class="gauge-label">חשיפה בנכסים הוניים</div>
                        <div class="gauge-sub">השתלמות והשקעות</div>
                    </div>
                    <div class="gauge-item">
                        <div class="gauge-wrapper">
                            <svg class="gauge-svg" viewBox="0 0 100 100">
                                <circle class="gauge-bg" cx="50" cy="50" r="42"></circle>
                                <circle class="gauge-fill" cx="50" cy="50" r="42" style="stroke-dashoffset: 79; stroke: var(--color-pension);"></circle>
                            </svg>
                            <div class="gauge-value">70%</div>
                        </div>
                        <div class="gauge-label">חשיפה בנכסים קצבתיים</div>
                        <div class="gauge-sub">פנסיה וגמל</div>
                    </div>
                </div>
            </section>

            <div id="dashboard-container" class="holdings-container"></div>

        </div>
    </div>

    <div class="page-break"></div>

    <!-- INSURANCE REPORT SECTION -->
    <div id="insurance-report" class="report-section">
        <div class="container container-wide">
            <header class="header-card">
                <div class="container header-content">
                    <div class="brand">
                        <div class="brand-icon-box"><i class="fas fa-shield-alt"></i></div>
                        <div class="brand-text">
                            <h1>דוח ביטוחי</h1>
                            <p>סקירת כיסויים ביטוחיים</p>
                        </div>
                    </div>
                </div>
            </header>
            <div style="padding: 40px; text-align: center; color: var(--text-secondary);">
                <i class="fas fa-info-circle" style="font-size: 48px; margin-bottom: 16px;"></i>
                <p>נתוני הביטוח יוצגו כאן לאחר טעינת המידע מהמערכת</p>
            </div>
        </div>
    </div>

    <div class="floating-footer no-print">
        <button class="btn btn-ghost" onclick="window.print()"><i class="fas fa-print"></i> הדפסה</button>
        <button class="btn btn-primary" onclick="exportToExcel()"><i class="fas fa-file-excel"></i> ייצוא לאקסל</button>
    </div>

    <script>
        const COMPANY_URLS = {
            'הפניקס': 'https://my.fnx.co.il/',
            'פניקס': 'https://my.fnx.co.il/',
            'מיטב': 'https://customers.meitav.co.il/v2/login/loginAmit',
            'כלל': 'https://www.clal.co.il/clal-online/login',
            'מור': 'https://www.more.co.il/personal-area/',
            'אלטשולר': 'https://www.as-invest.co.il/personal-area/',
            'הראל': 'https://www.harel-group.co.il/my-harel/pages/login.aspx',
            'מגדל': 'https://www.migdal.co.il/migdal-online',
            'מנורה': 'https://www.menoramivt.co.il/customer-service/online-services/',
            'אנליסט': 'https://amitim.analyst.co.il/auth/login?redirectUrl=%2Flobby'
        };

        // Sample portfolio data
        const portfolioData = {
            'פנסיה': [
                {
                    companyName: 'מיטב',
                    productName: 'קרן פנסיה מקיפה',
                    productNumber: '123456',
                    totalAccumulation: 450000,
                    tracks: [
                        {
                            trackName: 'מסלול כללי',
                            trackId: '5001',
                            trackAccumulation: 450000,
                            marketData: { ytdYield: 9.2, stockExposure: 70, return3Y: 28.5 },
                            hasAlert: true,
                            top3Alternatives: [
                                { name: 'מסלול מניות', yield: 12.5, exposure: 75, efficiency: 1.67 },
                                { name: 'מסלול צמיחה', yield: 11.2, exposure: 72, efficiency: 1.56 }
                            ]
                        }
                    ]
                }
            ],
            'גמל': [
                {
                    companyName: 'הפניקס',
                    productName: 'קופת גמל',
                    productNumber: '789012',
                    totalAccumulation: 280000,
                    tracks: [
                        {
                            trackName: 'מסלול אג"ח',
                            trackId: '6001',
                            trackAccumulation: 280000,
                            marketData: { ytdYield: 8.1, stockExposure: 45, return3Y: 22.3 },
                            hasAlert: false,
                            top3Alternatives: []
                        }
                    ]
                }
            ],
            'השתלמות': [
                {
                    companyName: 'הראל',
                    productName: 'קרן השתלמות',
                    productNumber: '345678',
                    totalAccumulation: 320000,
                    tracks: [
                        {
                            trackName: 'מסלול מנייתי',
                            trackId: '7001',
                            trackAccumulation: 320000,
                            marketData: { ytdYield: 8.8, stockExposure: 65, return3Y: 26.1 },
                            hasAlert: false,
                            top3Alternatives: []
                        }
                    ]
                }
            ],
            'השקעות אחרות': [
                {
                    companyName: 'אלטשולר שחם',
                    productName: 'גמל להשקעה',
                    productNumber: '901234',
                    totalAccumulation: 200000,
                    tracks: [
                        {
                            trackName: 'מסלול מניות',
                            trackId: '8001',
                            trackAccumulation: 200000,
                            marketData: { ytdYield: 11.5, stockExposure: 80, return3Y: 32.4 },
                            hasAlert: true,
                            top3Alternatives: [
                                { name: 'מסלול S&P 500', yield: 14.2, exposure: 85, efficiency: 1.67 }
                            ]
                        }
                    ]
                }
            ],
            'ביטוחי מנהלים': []
        };

        const categoryOrder = ['פנסיה', 'גמל', 'השתלמות', 'השקעות אחרות', 'ביטוחי מנהלים'];

        const formatCurrency = num => new Intl.NumberFormat('he-IL', { style: 'currency', currency: 'ILS', maximumFractionDigits: 0 }).format(num || 0);
        const formatPercent = num => (num !== null && num !== undefined && !isNaN(num)) ? num.toFixed(1) + '%' : '-';
        const calcEfficiency = (y, exp) => (!exp || exp === 0 || !y) ? 0 : ((y / exp) * 10).toFixed(1);

        function getStarRating(score) {
            const s = parseFloat(score);
            let stars = '';
            for (let i = 1; i <= 5; i++) {
                stars += i <= Math.round(s) ? '<span class="fill"></span>' : '<span></span>';
            }
            return stars;
        }

        function getCategoryIcon(catName) {
            const icons = {
                'פנסיה': '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>',
                'גמל': '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M19 5c-1.5 0-2.8 1.4-3 2-3.5-1.5-11-.3-11 5 0 1.8 0 3 2 4.5V20h4v-2h3v2h4v-4c1-.5 1.7-1 2-2h2v-4h-2c0-1-.5-1.5-1-2z"/><path d="M2 9v1c0 1.1.9 2 2 2h1"/></svg>',
                'השתלמות': '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M22 10v6M2 10l10-5 10 5-10 5z"/><path d="M6 12v5c0 2 2 3 6 3s6-1 6-3v-5"/></svg>',
                'השקעות אחרות': '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><circle cx="12" cy="12" r="8"/><path d="M12 8v8"/><path d="M8 12h8"/></svg>',
                'ביטוחי מנהלים': '<svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>'
            };
            return icons[catName] || icons['השקעות אחרות'];
        }

        function getCategoryColor(catName) {
            const colors = {
                'פנסיה': 'linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%)',
                'גמל': 'linear-gradient(135deg, #dc2626 0%, #f87171 100%)',
                'השתלמות': 'linear-gradient(135deg, #7c3aed 0%, #a78bfa 100%)',
                'השקעות אחרות': 'linear-gradient(135deg, #059669 0%, #34d399 100%)',
                'ביטוחי מנהלים': 'linear-gradient(135deg, #0891b2 0%, #22d3ee 100%)'
            };
            return colors[catName] || colors['השקעות אחרות'];
        }

        function getFallbackColor(name) {
            const n = name || '';
            if (n.includes('הפניקס') || n.includes('פניקס')) return '#f97316';
            if (n.includes('מיטב')) return '#4f46e5';
            if (n.includes('הראל')) return '#2563eb';
            if (n.includes('מגדל')) return '#0d9488';
            if (n.includes('כלל')) return '#0891b2';
            if (n.includes('אלטשולר')) return '#16a34a';
            if (n.includes('מור')) return '#9333ea';
            if (n.includes('אנליסט')) return '#0284c7';
            if (n.includes('מנורה')) return '#e11d48';
            return '#475569';
        }

        function getCompanyLoginUrl(name) {
            for (const [key, url] of Object.entries(COMPANY_URLS)) {
                if (name && name.includes(key)) return url;
            }
            return '#';
        }

        function toggle(id) {
            const el = document.getElementById(id);
            const chevron = document.getElementById('chevron-' + id);
            if (el) el.classList.toggle('open');
            if (chevron) chevron.classList.toggle('open');
        }

        function toggleTrack(id) {
            const el = document.getElementById(id);
            const isOpening = el && !el.classList.contains('open');

            document.querySelectorAll('.accordion-body.open').forEach(function(openEl) {
                if (openEl.id.includes('-t')) {
                    openEl.classList.remove('open');
                    var chevron = document.getElementById('chevron-' + openEl.id);
                    if (chevron) chevron.classList.remove('open');
                }
            });

            if (isOpening && el) {
                el.classList.add('open');
                var chevron = document.getElementById('chevron-' + id);
                if (chevron) chevron.classList.add('open');
            }
        }

        function scrollToReport() {
            document.getElementById('detailed-report').scrollIntoView({ behavior: 'smooth' });
        }

        function scrollToInsurance() {
            document.getElementById('insurance-report').scrollIntoView({ behavior: 'smooth' });
        }

        function exportToExcel() {
            let excelData = [["דוח תיק לקוח", "ישראל ישראלי"], ["תאריך", new Date().toLocaleDateString('he-IL')], []];
            categoryOrder.forEach(cat => {
                if (portfolioData[cat] && portfolioData[cat].length > 0) {
                    excelData.push([cat]);
                    excelData.push(["יצרן", "שם מוצר", "מספר חשבון", "יתרה מוצר", "מסלול", "קוד מסלול", "יתרה מסלול", "תשואה YTD", "תשואה 3 שנים", "חשיפה"]);
                    portfolioData[cat].forEach(p => {
                        p.tracks.forEach(t => {
                            excelData.push([
                                p.companyName, p.productName, p.productNumber, p.totalAccumulation,
                                t.trackName, t.trackId || '-', t.trackAccumulation,
                                (t.marketData.ytdYield || '-') + '%', (t.marketData.return3Y || '-') + '%',
                                (t.marketData.stockExposure || '-') + '%'
                            ]);
                        });
                    });
                    excelData.push([]);
                }
            });
            const ws = XLSX.utils.aoa_to_sheet(excelData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Portfolio");
            XLSX.writeFile(wb, "Portfolio_Report.xlsx");
        }

        function renderDashboard() {
            const container = document.getElementById('dashboard-container');
            let html = '';
            let catIndex = 0;

            categoryOrder.forEach(cat => {
                const products = portfolioData[cat];
                if (products && products.length > 0) {
                    const catTotal = products.reduce((s, p) => s + p.totalAccumulation, 0);
                    let catYieldSum = 0, catAccSum = 0;
                    products.forEach(p => {
                        p.tracks.forEach(t => {
                            catYieldSum += (t.trackAccumulation || 0) * (t.marketData?.ytdYield || 0);
                            catAccSum += t.trackAccumulation || 0;
                        });
                    });
                    const catYield = catAccSum > 0 ? (catYieldSum / catAccSum).toFixed(1) : 0;
                    const catId = 'cat-' + catIndex++;

                    html += `
                        <div class="category-card">
                            <div class="category-header" onclick="toggle('${catId}')">
                                <div class="cat-main">
                                    <div class="cat-icon" style="background: ${getCategoryColor(cat)};">
                                        ${getCategoryIcon(cat)}
                                    </div>
                                    <div class="cat-title">
                                        <h3>${cat}</h3>
                                        <div class="cat-meta">${products.length} מוצרים</div>
                                    </div>
                                </div>
                                <div class="cat-stats">
                                    <span class="amount">${formatCurrency(catTotal)}</span>
                                    <span class="yield">+${catYield}%</span>
                                </div>
                            </div>
                            <div id="${catId}" class="accordion-body">
                    `;

                    products.forEach((product, pIdx) => {
                        const prodId = catId + '-prod-' + pIdx;
                        const companyColor = getFallbackColor(product.companyName);
                        const initials = (product.companyName || '??').substring(0, 2);
                        const loginUrl = getCompanyLoginUrl(product.companyName);

                        let prodYieldSum = 0, prodAccSum = 0;
                        product.tracks.forEach(t => {
                            prodYieldSum += (t.trackAccumulation || 0) * (t.marketData?.ytdYield || 0);
                            prodAccSum += t.trackAccumulation || 0;
                        });
                        const prodAvgYield = prodAccSum > 0 ? (prodYieldSum / prodAccSum) : 0;

                        html += `
                            <div class="product-row" onclick="toggle('${prodId}'); event.stopPropagation();">
                                <div class="product-info">
                                    <span class="company-logo" style="background: ${companyColor}">${initials}</span>
                                    <div>
                                        <div class="product-name">${product.productName}</div>
                                        <div class="product-meta">${product.companyName} | קופה ${product.productNumber || '-'} | ${product.tracks.length} מסלולים</div>
                                    </div>
                                </div>
                                <div class="product-stats">
                                    <div class="product-amount">${formatCurrency(product.totalAccumulation)}</div>
                                    <div class="product-yield ${prodAvgYield >= 0 ? 'text-green' : ''}">${prodAvgYield >= 0 ? '+' : ''}${prodAvgYield.toFixed(1)}%</div>
                                </div>
                                <i id="chevron-${prodId}" class="chevron"></i>
                            </div>
                            <div id="${prodId}" class="accordion-body">
                                <div class="track-container">
                        `;

                        product.tracks.forEach((track, tIdx) => {
                            const trackId = prodId + '-t' + tIdx;
                            const ytd = track.marketData?.ytdYield || 0;
                            const exposure = track.marketData?.stockExposure || 0;
                            const efficiency = calcEfficiency(ytd, exposure);
                            const hasAlert = track.hasAlert && track.top3Alternatives && track.top3Alternatives.length > 0;
                            const alertIcon = hasAlert ? '<span class="alert-icon" title="יש המלצה לבחינה"><i class="fas fa-lightbulb"></i></span>' : '';

                            html += `
                                <div class="track-row ${hasAlert ? 'has-alert' : ''}" onclick="toggleTrack('${trackId}'); event.stopPropagation();">
                                    <div class="track-title">
                                        <h5>${alertIcon}${track.trackName}</h5>
                                        <div class="track-sub">${formatCurrency(track.trackAccumulation)}</div>
                                    </div>
                                    <div class="mini-stat">
                                        <div class="mini-val ${ytd >= 0 ? 'text-green' : ''}">${formatPercent(ytd)}</div>
                                        <div class="mini-label">תשואה</div>
                                    </div>
                                    <div class="mini-stat">
                                        <div class="mini-val">${exposure.toFixed(1)}%</div>
                                        <div class="mini-label">חשיפה</div>
                                    </div>
                                    <i id="chevron-${trackId}" class="chevron"></i>
                                </div>
                                <div id="${trackId}" class="accordion-body">
                                    <div class="track-details">
                                        <div class="metrics-strip">
                                            <div class="metric-box"><div class="label">תשואה YTD</div><div class="val ${ytd >= 0 ? 'text-green' : ''}">${formatPercent(ytd)}</div></div>
                                            <div class="metric-box"><div class="label">תשואה 3 שנים</div><div class="val">${track.marketData?.return3Y ? formatPercent(track.marketData.return3Y) : '-'}</div></div>
                                            <div class="metric-box"><div class="label">חשיפה למניות</div><div class="val">${exposure.toFixed(1)}%</div></div>
                                            <div class="metric-box"><div class="label">מדד יעילות</div><div class="val">${efficiency} <span class="efficiency-dots" style="display: inline-flex; vertical-align: middle; margin-right: 4px;">${getStarRating(efficiency)}</span></div></div>
                                        </div>
                            `;

                            if (hasAlert) {
                                html += `
                                    <div class="alt-table-wrapper">
                                        <div class="alt-table-header">חלופות מומלצות בחשיפה דומה</div>
                                        <table class="alt-table">
                                            <thead><tr><th>שם מסלול</th><th>תשואה</th><th>חשיפה</th><th>יעילות</th></tr></thead>
                                            <tbody>
                                `;
                                track.top3Alternatives.forEach(alt => {
                                    const altEff = calcEfficiency(alt.yield, alt.exposure);
                                    const altExp = typeof alt.exposure === 'number' ? alt.exposure.toFixed(1) : alt.exposure;
                                    html += `
                                        <tr>
                                            <td><span class="badge-rec">מומלץ</span>${alt.name}</td>
                                            <td class="text-green">${formatPercent(alt.yield)}</td>
                                            <td>${altExp}%</td>
                                            <td>${altEff} <span class="efficiency-dots" style="display: inline-flex; vertical-align: middle; margin-right: 4px;">${getStarRating(altEff)}</span></td>
                                        </tr>
                                    `;
                                });
                                html += `
                                            </tbody>
                                        </table>
                                    </div>
                                    <div style="margin-top: 12px; text-align: left;">
                                        <a href="${loginUrl}" target="_blank" class="btn btn-primary" style="display: inline-flex; font-size: 12px; padding: 8px 16px;">
                                            <i class="fas fa-external-link-alt"></i> לשינוי מסלול
                                        </a>
                                    </div>
                                `;
                            }

                            html += `
                                    </div>
                                </div>
                            `;
                        });

                        html += `
                                </div>
                            </div>
                        `;
                    });

                    html += `
                            </div>
                        </div>
                    `;
                }
            });

            container.innerHTML = html;
        }

        window.onload = renderDashboard;
    </script>
</body>
</html>